{{ $html := path.Join .Page.File.Dir "html.inc" | readFile }}
{{ $css := path.Join .Page.File.Dir "css.inc" | readFile }}

<div class="codepen">
    {{ $htmlcontent := printf "%s%s%s" "<div ng-app=\"ods-widgets\">\n" $html "</div>" }}
    {{ $csscontent := $css }}
    {{ $head := "/layouts/partials/includes.html" | readFile | jsonify }}

    <form id="form-{{ .Page.Title | urlize}}"
          action="https://codepen.io/pen/define"
          method="POST"
          target="_blank">
        <input type="hidden" name="data" value='{
                                "title": "New Pen!",
                                "head": {{ $head }},
                                "editors": 110,
                                "html": {{ $htmlcontent | jsonify }},
                                "css": {{ $csscontent | jsonify }} }'>
    </form>
</div>

<div class="ods-content">
    <section class="box box-live-example">
        <div class="row">
            <iframe id="iframe-{{ .Page.Title | urlize}}"
                    width="100%" height="600px"
                    src="about:blank"
                    srcdoc="
                <head>{{ "/layouts/partials/includes.html" | readFile }}
            {{ $style := resources.Get "scss/main.scss" | resources.ToCSS }}
            <!--link rel='stylesheet' href='{{ $style.RelPermalink }}' /-->
            </head>
            <body>
            <div ng-app='ods-widgets'>
                {{ $html }}
            </div>
            <style type='text/css'>
                {{ $css }}
            </style>
            </body>
            ">
            </iframe>
        </div>
    </section>

    <section class="box box-code mb-0">
            <nav class="level">
                <div class="level-left">
                    <div class="level-item">
                        <div class="btn-group nav" role="tablist">
                                <a class="button btn"
                                   id="{{ .Page.Title | urlize}}-html"
                                   data-toggle="tab"
                                   href="#code-{{ .Page.Title | urlize}}-html-content"
                                   role="tab"
                                   aria-controls="code-{{ .Page.Title | urlize}}-html-content"
                                   aria-selected="true">
                                    HTML
                                </a>
                                <a class="button btn"
                                   id="{{ .Page.Title | urlize}}-css"
                                   data-toggle="tab"
                                   href="#code-{{ .Page.Title | urlize}}-css-content"
                                   role="tab"
                                   aria-controls="code-{{ .Page.Title | urlize}}-css-content"
                                   aria-selected="false">
                                    CSS
                                </a>
                                <a class="button btn"
                                   target="_blank"
                                   rel="noopener"
                                   href="#"
                                   title="Edit on CodePen"
                                   onclick="document.getElementById('form-{{ .Page.Title | urlize}}').submit()">
                                    Edit on Codepen
                                </a>
                        </div>
                    </div>
                </div>
                <div class="level-right">
                    <button class="button is-rounded is-outlined">
                        Copy
                    </button>
                </div>
            </nav>


            <div class="tab-content"
                 id="code-tabContent">
                <div class="tab-pane fade show active"
                     id="code-{{ .Page.Title | urlize}}-html-content"
                     role="tabpanel"
                     aria-labelledby="code-{{ .Page.Title | urlize}}-html-tab">
                    <div class="highlight">
                        <pre class="language-html" data-lang="html"><code>{{ $html }}</code></pre>
                    </div>
                </div>
                <div class="tab-pane fade"
                     id="code-{{ .Page.Title | urlize}}-css-content"
                     role="tabpanel"
                     aria-labelledby="code-{{ .Page.Title | urlize}}-css-tab">
                    <div class="highlight">
                        <pre class="language-css" data-lang="css"><code>{{ $css }}</code></pre>
                    </div>
                </div>
            </div>
    </section>
</div>

