{{ $html := path.Join .Page.Dir "html.inc" | readFile }}
{{ $css := path.Join .Page.Dir "css.inc" | readFile }}

<div class="codepen">
    {{ $htmlcontent := printf "%s%s%s" "<div ng-app=\"ods-widgets\">\n" $html "</div>" }}
    {{ $csscontent := $css }}
    {{ $head := "/layouts/partials/includes.html" | readFile | jsonify }}

    <form id="form-{{ .Page.Slug }}" action="https://codepen.io/pen/define" method="POST" target="_blank">
        <input type="hidden" name="data" value='{
                                "title": "New Pen!",
                                "head": {{ $head }},
                                "editors": 110,
                                "html": {{ $htmlcontent | jsonify }},
                                "css": {{ $csscontent | jsonify }} }'>
    </form>
</div>

<div class="ods-content">
    <nav>
        <div class="nav nav-tabs justify-content-center" id="nav{{ .Page.Slug }}-tab" role="tablist">
            <a class="nav-item nav-link active" id="nav{{ .Page.Slug }}-live-tab" data-toggle="tab" href="#nav{{ .Page.Slug }}-live" role="tab" aria-controls="nav{{ .Page.Slug }}-live" aria-selected="true">Live snippet</a>
            <a class="nav-item nav-link" id="nav{{ .Page.Slug }}-code-tab" data-toggle="tab" href="#nav{{ .Page.Slug }}-code" role="tab" aria-controls="nav{{ .Page.Slug }}-code" aria-selected="false">Get the code</a>
        </div>
    </nav>

    <div class="tab-content" id="{{ .Page.Slug }}">
        <div class="tab-pane fade show active" id="nav{{ .Page.Slug }}-live" role="tabpanel" aria-labelledby="nav{{ .Page.Slug }}-live-tab">
            <div class="row">
                <iframe id="iframe-{{ .Page.Slug }}" width="100%" height="600px" src="about:blank"
                    srcdoc="
<head>{{ "/layouts/partials/includes.html" | readFile }}</head>
<body>
<div ng-app='ods-widgets'>
    {{ $html }}
</div>
<style type='text/css'>
    {{ $css }}
</style>
</body>
"></iframe>
            </div>
        </div>
        <div class="tab-pane fade" id="nav{{ .Page.Slug }}-code" role="tabpanel" aria-labelledby="nav{{ .Page.Slug }}-code-tab">
            <div class="row">
                <div class="col-2">
                    <div class="nav flex-column nav-pills" id="code-{{ .Page.Slug }}-tab" role="tablist" aria-orientation="vertical">
                        <a class="nav-link active" id="code-{{ .Page.Slug }}-html-tab" data-toggle="pill" href="#code-{{ .Page.Slug }}-html-content" role="tab" aria-controls="code-{{ .Page.Slug }}-html-content" aria-selected="true">
                            HTML
                        </a>
                        <a class="nav-link" id="code-{{ .Page.Slug }}-css-tab" data-toggle="pill" href="#code-{{ .Page.Slug }}-css-content" role="tab" aria-controls="code-{{ .Page.Slug }}-css-content" aria-selected="false">
                            CSS
                        </a>
                    </div>

                    <a class="edit-on-codepen" target="_blank" rel="noopener" href="#" title="Edit on CodePen"
                       onclick="document.getElementById('form-{{ .Page.Slug }}').submit()">
                        <span class="codepen-edit-on-text">EDIT ON</span>
                        <svg class="codepen-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 138 26" fill="none" stroke="#000" stroke-width="2.3" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M80 6h-9v14h9m34-14h-9v14h9m-3-7h-6m-28 0h-6m51 7V6l11 14V6M22 16.7L33 24l11-7.3V9.3L33 2 22 9.3v7.4zm22 0L33 9.3l-11 7.4m0-7.4l11 7.3 11-7.3M33 2v7.3m0 7.4V24m55-10h6c2.2 0 4-1.8 4-4s-1.8-4-4-4h-6v14M15 8c-1.3-1.3-3-2-5-2-4 0-7 3-7 7s3 7 7 7c2 0 3.7-.8 5-2m49-5c0 4-3 7-7 7h-5V6h5c4 0 7 3 7 7z"></path>
                        </svg>
                    </a>
                </div>
                <div class="col-10">
                    <div class="tab-content" id="code-tabContent">
                        <div class="tab-pane fade show active" id="code-{{ .Page.Slug }}-html-content" role="tabpanel" aria-labelledby="code-{{ .Page.Slug }}-html-tab">
                            <div class="highlight">
                                <pre class="language-html" data-lang="html"><code>{{ $html }}</code></pre>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="code-{{ .Page.Slug }}-css-content" role="tabpanel" aria-labelledby="code-{{ .Page.Slug }}-css-tab">
                            <div class="highlight">
                                <pre class="language-css" data-lang="css"><code>{{ $css }}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

